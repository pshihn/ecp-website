class t extends HTMLElement{constructor(){super(),this.__n=new Map,this.root=this.attachShadow({mode:"open"})}static get observedAttributes(){return["value"]}attributeChangedCallback(t,n,e){"value"===t&&(this.value=e)}$(t){if(this.__n.has(t))return this.__n.get(t);const n=this.root.querySelector("#"+t);return this.__n.set(t,n),n}$add(t,n,e){"string"==typeof t&&(t=this.$(t)),t&&t.addEventListener(n,e)}$remove(t,n,e){"string"==typeof t&&(t=this.$(t)),t&&t.removeEventListener(n,e)}fire(t,n){!function(t,n,e){const i={bubbles:!0,composed:!0,detail:e};t.dispatchEvent(new CustomEvent(n,i))}(this,t,n)}disconnectedCallback(){this.__n.clear()}}const n=/^hsla\s*\(\s*(\d+.?\d*)\s*,\s*(\d+.?\d*)%\s*,\s*(\d+.?\d*)%\s*,\s*(\d+.?\d*)\s*\)$/i,e=/^hsl\s*\(\s*(\d+.?\d*)\s*,\s*(\d+.?\d*)%\s*,\s*(\d+.?\d*)%\s*\)$/i,i=/^rgba\s*\(\s*(\d+.?\d*)\s*,\s*(\d+.?\d*)\s*,\s*(\d+.?\d*)\s*,\s*(\d+.?\d*)\s*\)$/i,s=/^rgb\s*\(\s*(\d+.?\d*)\s*,\s*(\d+.?\d*)\s*,\s*(\d+.?\d*)\s*\)$/i;function r(t,n,e){t%=360,n/=100,e/=100;const i=(1-Math.abs(2*e-1))*n,s=i*(1-Math.abs(t/60%2-1)),r=e-i/2;let o=0,h=0,a=0;return[o,h,a]=t<60?[i,s,0]:t<120?[s,i,0]:t<180?[0,i,s]:t<240?[0,s,i]:t<300?[s,0,i]:[i,0,s],[Math.round(255*(o+r)),Math.round(255*(h+r)),Math.round(255*(a+r))]}function o(t){const[n,e,i,s]=t,r=(2-e/100)*i/2,o=r<50?2*r:200-2*r,h=o?e*i/o:0;return[n,Math.round(h),Math.round(r),s]}function h(t,n,e){t/=255,n/=255,e/=255;const i=Math.max(t,n,e),s=Math.min(t,n,e),r=i-s;let o=0;0===r?o=0:i===t?o=(n-e)/r%6*60:i===n?o=60*((e-t)/r+2):i===e&&(o=60*((t-n)/r+4));const h=(i+s)/2,a=0===r?0:r/(1-Math.abs(2*h-1));return[Math.round((360+o)%360),Math.round(100*a),Math.round(100*h)]}function a(t,n,e,i){i=Math.round(255*i);let s=Math.round(t).toString(16),r=Math.round(n).toString(16),o=Math.round(e).toString(16),h=i.toString(16);return 1===s.length&&(s="0"+s),1===r.length&&(r="0"+r),1===o.length&&(o="0"+o),1===h.length&&(h="0"+h),(255===i?`#${s}${r}${o}`:`#${s}${r}${o}${h}`).toUpperCase()}const d="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAF0lEQVR42mM4Awb/wYCBYg6EgghRzAEAWDWBGQVyKPMAAAAASUVORK5CYII=";function u(t){let n=-1;return self.Touch&&t instanceof Touch?n=t.identifier:c(t)&&(n=t.pointerId),{id:n,nativeEvent:t,clientX:t.clientX,clientY:t.clientY}}const c=t=>self.PointerEvent&&t instanceof PointerEvent;class l{constructor(t,n){this.startPointers=[],this.currentPointers=[],this.pointerStart=t=>{if(0===t.button&&this.triggerPointerStart(u(t),t))if(c(t)){(t.target&&"setPointerCapture"in t.target?t.target:this._e).setPointerCapture(t.pointerId),this.ael("pointermove",this.move),this.ael("pointerup",this.pointerEnd),this.ael("pointercancel",this.pointerEnd)}else window.addEventListener("mousemove",this.move),window.addEventListener("mouseup",this.pointerEnd)},this.touchStart=t=>{for(const n of Array.from(t.changedTouches))this.triggerPointerStart(u(n),t)},this.move=t=>{const n="changedTouches"in t?Array.from(t.changedTouches).map((t=>u(t))):[u(t)],e=[];for(const t of n){const n=this.currentPointers.findIndex((n=>n.id===t.id));-1!==n&&(e.push(t),this.currentPointers[n]=t)}0!==e.length&&this._h.onMove(e,t)},this._end=(t,n)=>{const e=this.currentPointers.findIndex((n=>n.id===t.id));return-1!==e&&(this.currentPointers.splice(e,1),this.startPointers.splice(e,1),this._h.onEnd&&this._h.onEnd(t,n,"touchcancel"===n.type||"pointercancel"===n.type),!0)},this.pointerEnd=t=>{if(this._end(u(t),t))if(c(t)){if(this.currentPointers.length)return;this.rel("pointermove",this.move),this.rel("pointerup",this.pointerEnd),this.rel("pointercancel",this.pointerEnd)}else window.removeEventListener("mousemove",this.move),window.removeEventListener("mouseup",this.pointerEnd)},this.touchEnd=t=>{for(const n of Array.from(t.changedTouches))this._end(u(n),t)},this._e=t,this._h=n,self.PointerEvent?this.ael("pointerdown",this.pointerStart):(this.ael("mousedown",this.pointerStart),this.ael("touchstart",this.touchStart),this.ael("touchmove",this.move),this.ael("touchend",this.touchEnd),this.ael("touchcancel",this.touchEnd))}ael(t,n){this._e.addEventListener(t,n)}rel(t,n){this._e.removeEventListener(t,n)}stop(){this.rel("pointerdown",this.pointerStart),this.rel("mousedown",this.pointerStart),this.rel("touchstart",this.touchStart),this.rel("touchmove",this.move),this.rel("touchend",this.touchEnd),this.rel("touchcancel",this.touchEnd),this.rel("pointermove",this.move),this.rel("pointerup",this.pointerEnd),this.rel("pointercancel",this.pointerEnd),window.removeEventListener("mousemove",this.move),window.removeEventListener("mouseup",this.pointerEnd)}triggerPointerStart(t,n){return!!this._h.onStart(t,n)&&(this.currentPointers.push(t),this.startPointers.push(t),!0)}}class p{constructor(t,n){this.anchor=[0,0,0,0],this.p=[0,0],this.pAnchor=[0,0],this.e=t,n&&(this.p=this.clamp(n)),this.tracker=new l(this.e,this)}get position(){return this.p}set position(t){this.p=this.clamp(t)}clamp(t){return[Math.max(0,Math.min(1,t[0])),Math.max(0,Math.min(1,t[1]))]}onStart(t,n){n.preventDefault();const e=this.e.getBoundingClientRect();this.anchor=[e.left||e.x,e.top||e.y,e.width,e.height];const i=this.anchor[2],s=this.anchor[3],r=i?(t.clientX-this.anchor[0])/i:0,o=s?(t.clientY-this.anchor[1])/s:0;return this.setPosition(r,o),this.pAnchor=[...this.p],this.e.style.cursor="pointer",!0}onMove(t){const n=t[0];if(n){const t=this.anchor[2],e=this.anchor[3],i=t?(n.clientX-this.anchor[0])/t:0,s=e?(n.clientY-this.anchor[1])/e:0;this.setPosition(i,s)}}onEnd(t,n,e){this.e.style.cursor="",e&&this.setPosition(...this.pAnchor)}setPosition(t,n){const[e,i]=this.clamp([t,n]);return(e!==this.p[0]||i!==this.p[1])&&(this.p=[e,i],this.fire(),!0)}fire(){this.e.dispatchEvent(new CustomEvent("p-input",{bubbles:!0,composed:!0,detail:[...this.p]}))}detach(){this.tracker.stop()}}class g extends t{constructor(){super(),this._hsv=[0,100,100,1],this.onSLChange=()=>{const[t,n]=this.rc.position;this._hsv[1]=Math.max(0,Math.min(100,Math.round(100*t))),this._hsv[2]=Math.max(0,Math.min(100,Math.round(100*(1-n)))),this.updateColor(),this._fire()},this.onHueChange=()=>{const t=this.$("hue"),n=Math.round(+t.value);n!==this._hsv[0]&&(this._hsv[0]=n,this.updateColor(),this._fire())},this.onAlphaChange=()=>{const t=+this.$("alpha").value/100;t!==this._hsv[3]&&(this._hsv[3]=t,this.updateColor(),this._fire())},this.root.innerHTML=`\n    <style>\n      \n* {box-sizing: border-box;}\n.horizontal {display: flex; flex-direction: row;}\n.vertical {display: flex; flex-direction: column;}\n.center {align-items: center;}\n.flex {flex: 1;}\n\n      :host {\n        display: inline-block;\n        touch-action: none;\n        width: 280px;\n        height: 280px;\n      }\n      #grid {\n        display: grid;\n        grid-template-columns: 1fr auto;\n        grid-template-rows: 1fr auto;\n        height: 100%;\n        position: relative;\n      }\n      #base {\n        position: relative;\n        background: hsl(var(--lucid-cp-hue, 0), 100%, 50%);\n      }\n      #thumb {\n        position: absolute;\n        width: 20px;\n        height: 20px;\n        border-radius: 50%;\n        box-shadow: 0 2px 1px -1px rgba(0,0,0,.2), 0 1px 1px 0 rgba(0,0,0,.14), 0 1px 3px 0 rgba(0,0,0,.12);\n        border: 2px solid #ffffff;\n        top: -10px;\n        left: -10px;\n        cursor: pointer;\n        z-index: 1;\n      }\n      #base1,\n      #base2 {\n        position: absolute;\n        top: 0;\n        left: 0;\n        width: 100%;\n        height: 100%;\n        border: none;\n      }\n      #base1 {\n        background: linear-gradient(to right, #fff 0%, rgba(255, 255, 255, 0) 100%);\n      }\n      #base2 {\n        background: linear-gradient(to bottom, transparent 0%, #000 100%);\n      }\n      #previewPanel {\n        position: relative;\n        border-radius: 50%;\n        overflow: hidden;\n        margin: 4px 0 0 4px;\n        background-image: url(${d});\n      }\n      #preview {\n        position: absolute;\n        top: 0;\n        left: 0;\n        width: 100%;\n        height: 100%;\n      }\n      #huePanel {\n        overflow: hidden;\n        width: 40px;\n        position: relative;\n        background-image: linear-gradient(to top, hsl(0, 100%, 50%), hsl(60, 100%, 50%), hsl(120, 100%, 50%), hsl(180, 100%, 50%), hsl(240, 100%, 50%), hsl(300, 100%, 50%), hsl(0, 100%, 50%));\n      }\n      #alphaPanel {\n        height: 40px;\n        position: relative;\n        background-image: url(${d});\n        background-size: 12px 11px;\n      }\n      #alphaGradient {\n        position: absolute;\n        top: 0;\n        left: 0;\n        width: 100%;\n        height: 100%;\n      }\n      #hue {\n        transform: translate3d(20px, 0,0) translate3d(-50%, 0,0) rotate(-90deg);\n        width: 240px;\n      }\n      input[type=range] {\n        width: 100%;\n        height: 100%;\n        -webkit-appearance: none;\n        background: rgba(0,0,0,0.2);\n        box-sizing: border-box;\n        margin: 0;\n        outline: none;\n        position: relative;\n        pointer-events: auto;\n        display: block;\n      }\n      input[type=range]:focus {\n        outline: none;\n      }\n      input[type=range]::-ms-track {\n        width: 100%;\n        cursor: pointer;\n        background: transparent;\n        border-color: transparent;\n        color: transparent;\n      }\n      input[type=range]::-moz-focus-outer {\n        outline: none;\n        border: 0;\n      }\n      input[type=range]::-moz-range-thumb {\n        background: transparent;\n        cursor: pointer;\n        border: 2px solid #fff;\n        height: 10px;\n        width: 10px;\n        border-radius: 50%;\n        margin: 0;\n      }\n      input[type=range]::-webkit-slider-thumb {\n        -webkit-appearance: none;\n        background: transparent;\n        cursor: pointer;\n        border: 2px solid #fff;\n        height: 10px;\n        width: 10px;\n        border-radius: 50%;\n        margin: 0;\n      }\n    </style>\n    <div id="grid">\n      <div id="base">\n        <div id="base1"></div>\n        <div id="base2">\n          <div id="thumb"></div>\n        </div>\n      </div>\n      <div id="huePanel">\n        <input id="hue" type="range" min="0" max="360" value="0" aria-label="Hue">\n      </div>\n      <div id="alphaPanel">\n        <div id="alphaGradient"></div>\n        <input id="alpha" type="range" min="0" max="100" value="100" aria-label="Alpha">\n      </div>\n      <div id="previewPanel">\n        <div id="preview"></div>\n      </div>\n    </div>\n    `}connectedCallback(){const t=this.$("base2");this.rc=new p(t,[.5,.5]),this.$add(t,"p-input",this.onSLChange),this.$add("hue","input",this.onHueChange),this.$add("alpha","input",this.onAlphaChange),this.updateColor()}disconnectedCallback(){this.rc&&(this.rc.detach(),this.rc=void 0);const t=this.$("base2");t&&(this.$remove(t,"p-input",this.onSLChange),this.$remove("hue","input",this.onHueChange),this.$remove("alpha","input",this.onAlphaChange)),super.disconnectedCallback()}updateColor(){this.updateThumbPosition(),this.$("hue").value=""+this._hsv[0],this.$("alpha").value=""+100*this._hsv[3];const t=o(this._hsv);var n;this.$("preview").style.background=`hsla(${(n=t)[0]%360}, ${n[1]}%, ${n[2]}%, ${n[3]})`,this.style.setProperty("--lucid-cp-hue",""+this._hsv[0]),this.$("alphaGradient").style.backgroundImage=`linear-gradient(to right, hsla(${t[0]}, ${t[1]}%, ${t[2]}%, 0), hsla(${t[0]}, ${t[1]}%, ${t[2]}%, 1))`}updateThumbPosition(){if(this.rc){const[n,e,i]=this._hsv;this.rc.position=[e/100,1-i/100];const s=this.$("thumb"),r=this.rc.position,{width:h,height:a}=this.$("base2").getBoundingClientRect(),[d,u]=[h*r[0],a*r[1]];s.style.transform=`translate3d(${d}px, ${u}px, 0)`,s.style.background=`hsl(${(t=o([n,e,i,1]))[0]%360}, ${t[1]}%, ${t[2]}%)`}var t}_fire(){this.fire("change")}get hsl(){return o(this._hsv)}get rgb(){return function(t){const[n,e,i,s]=o(t),[h,a,d]=r(n,e,i);return[h,a,d,s]}(this._hsv)}get value(){return a(...this.rgb)}set value(t){const o=function(t){let o=(t=t.trim()).match(n);if(o){const t=+o[1],n=+o[2],e=+o[3],i=+o[4],[s,h,d]=r(t,n,e);return{hex:a(s,h,d,i),hsla:[t,n,e,i],rgba:[s,h,d,i]}}if(o=t.match(e),o){const t=+o[1],n=+o[2],e=+o[3],[i,s,h]=r(t,n,e);return{hex:a(i,s,h,1),hsla:[t,n,e,1],rgba:[i,s,h,1]}}if(o=t.match(i),o){const t=+o[1],n=+o[2],e=+o[3],i=+o[4],[s,r,d]=h(t,n,e);return{hex:a(t,n,e,i),hsla:[s,r,d,i],rgba:[t,n,e,i]}}if(o=t.match(s),o){const t=+o[1],n=+o[2],e=+o[3],[i,s,r]=h(t,n,e);return{hex:a(t,n,e,1),hsla:[i,s,r,1],rgba:[t,n,e,1]}}let d=t;const u=d.lastIndexOf("#");u>=0&&(d=d.substring(u+1));const c=function(t){switch(t.length){case 3:return[+`0x${t[0]}${t[0]}`,+`0x${t[1]}${t[1]}`,+`0x${t[2]}${t[2]}`,1];case 4:return[+`0x${t[0]}${t[0]}`,+`0x${t[1]}${t[1]}`,+`0x${t[2]}${t[2]}`,+`0x${t[3]}${t[3]}`/255];case 6:return[+`0x${t[0]}${t[1]}`,+`0x${t[2]}${t[3]}`,+`0x${t[4]}${t[5]}`,1];case 8:return[+`0x${t[0]}${t[1]}`,+`0x${t[2]}${t[3]}`,+`0x${t[4]}${t[5]}`,+`0x${t[6]}${t[7]}`/255]}return null}(d);if(c){const[t,n,e,i]=c;if(isNaN(t)||isNaN(n)||isNaN(e)||isNaN(i))return null;const[s,r,o]=h(t,n,e);return{hex:a(t,n,e,i),hsla:[s,r,o,i],rgba:[t,n,e,i]}}return null}(t);o&&(this._hsv=function(t){const[n,e,i,s]=t,r=e*(i<50?i:100-i)/100;return[n,Math.round(i+r?200*r/(i+r):0),Math.round(r+i),s]}(o.hsla),this.updateColor())}}customElements.define("lucid-color-picker",g);export{g as LucidColorPicker};
